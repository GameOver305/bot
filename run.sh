#!/bin/bash

#â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
#â•‘   Ø³ÙƒØ±Ø¨Øª ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª Ù…Ø¹ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ   â•‘
#â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

echo ""
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘     ğŸ¤– Discord Alliance Bot Launcher   â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø¨ÙˆØª
cd "$(dirname "$0")"

# Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ node_modules
if [ ! -d "node_modules" ]; then
    echo "ğŸ“¦ Ø¬Ø§Ø±ÙŠ ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ù„Ø£ÙˆÙ„ Ù…Ø±Ø©..."
    npm install
    echo ""
fi

# Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù…Ù„Ù .env
if [ ! -f ".env" ]; then
    echo "âš ï¸ Ù…Ù„Ù .env ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯!"
    echo "ğŸ“ Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù…ÙˆØ°Ø¬..."
    echo "DISCORD_TOKEN=your_bot_token_here" > .env
    echo "OWNER_ID=your_discord_id_here" >> .env
    echo "AUTO_UPDATE=true" >> .env
    echo ""
    echo "âš ï¸ ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¯ÙŠÙ„ Ù…Ù„Ù .env ÙˆØ¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙˆÙƒÙ† Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ"
    exit 1
fi

# ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª
echo "ğŸš€ Ø¬Ø§Ø±ÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª..."
echo ""

# Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ¦Ø©
if command -v pm2 &> /dev/null; then
    echo "ğŸ“¦ ØªÙ… Ø§ÙƒØªØ´Ø§Ù PM2 - Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ´ØºÙŠÙ„..."
    pm2 start ecosystem.config.js --update-env
else
    # ØªØ´ØºÙŠÙ„ Ø¹Ø§Ø¯ÙŠ
    node src/index.js
fi
